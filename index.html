<html>
<head>
  <script src="library/HandleBars.js"></script>

  <script src="library/jquery.js"></script>
  <script src="library/underscore.js"></script>
  <script src="library/backbone.js"></script>
  <script src="library/style.css" type="style"></script>
  <link rel="stylesheet" href="library/style.css" type="text/css">
  <script src="library/Chart.js"></script>
</head>
<body>
  <title>The Typist</title>
  <canvas id="myChart"></canvas>
    <div id="start"><button id="beginning">click to begin your typing challenge</button>
      <span id="first"></span></div>
    <div id="go"><span id="typed"></span><span id="selector"></span><span id="toDo"></span></div>
    <div id="fifth"></div>
    <div id="sixth"><p>Penalties...</p></div>
</body>
<script>

var data = [0];
var dataPenalty = [0];
var labels = ["Start"];
var penalty = 5;
//CLICK TO BEGIN
$('#beginning').click(function() {
  
  var timeStart = $.now();
  var snippet = "1234567891011121314151617181920";

  //START WITH DEFAULT TEXT
  $('#selector').html(selector);
    $('#typed').html(typed);
    $('#toDo').html(toDo)
  $('#fifth').html(snippet);
  var i = 0;
  var keyHit = 0
  //KEYPRESS ACTIONS
  $('body').keypress(function(event) {
    var selector = snippet[i];
    var end = snippet.length;
    var typed = snippet.slice(0,i);
    var toDo = snippet.slice(i+1,end);
    $('#fifth').hide();
    //KEY HIT CONDITIONALS/ACTIONS
    if(String.fromCharCode(event.which)!==snippet[i-1]) {
      var error = "  X  ";
      $("#sixth p").append(error);
      keyHit+= 2;
    };
    
    //RENDER SPANS ON EACH KEY
    $('#selector').html(selector);
    $('#typed').html(typed);
    $('#toDo').html(toDo)
    i++;

    //END OF LINE - SO DO THIS STUFF:
    if(snippet[snippet.length] === selector){
      console.log('selector reached end...')

      //CREATE LINE CHART
      var canvas = $("#myChart").get(0);
      var ctx = canvas.getContext("2d");
      ctx.width = canvas.width = 820;
      ctx.height = canvas.height = 155;
      var config = {
        datasets : [
          {
            fillColor : "rgba(220,20,20,0.5)",
            strokeColor : "rgba(220,20,20,1)",
            pointColor : "rgba(220,20,20,1)",
            pointStrokeColor : "#fff",
            data : data
          },
          {
            fillColor : "rgba(111,147,220,0.5)",
            strokeColor : "rgba(111,147,220,1)",
            pointColor : "rgba(111,147,220,1)",
            pointStrokeColor : "#fff",
            data : data //push new value of time stamp/1000
          }
        ]
      };

      //RECORD THE TIME STAMP SCORE
      var stop = $.now();
      var result = (stop - timeStart)/1000;
      console.log(result)
      console.log(keyHit)
      //POST SCORE INTO DATA AS NEXT:
      data.push(result);
      console.log(data, 'dp')
      labels.push("Run " + 1)
      dataPenalty.push(keyHit);
      config.datasets[0].data = data;
      config.datasets[1].data = dataPenalty;
      config.labels = labels;

      //ISTANTIATE CHART
      var myNewChart = new Chart(ctx).Line(config,options);
    };
  });
});



</script>
</html>
